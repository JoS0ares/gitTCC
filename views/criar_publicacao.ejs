<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar publicacao</title>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
</head>
<style>
    * {
        padding: 0px;
        margin: 0px;
    }
    .modal {
        opacity: 0;
        pointer-events: none;
        display: none;
    }
    .modal:target {
        display: block;
        opacity: 1;
        pointer-events: auto;
    }
</style>
<body>
    <header>
        <a href="#deseja_voltar">Voltar</a>
    </header>

    <main>
        <p>
            <h1><%= document.nome_public %></h1>
            <h4><%= document.desc_adicional + " / " + document.nome_banda %></h4>
        </p>
        <%
        tablatura._trechos.forEach(e => {
        %>
        <div id="confirmar_delete<%=e.nome%>" class="modal">
            <div>
                <a href="#fechar" title="fechar" class="fechar">X</a>
                <h2>Deseja mesmo deletar este trecho?</h2>
                <a href="/delete_trecho/<%=tablatura._id%>/<%=e.nome%>">confirmar</a>
            </div>
        </div>
        <table id="p_<%=e.nome%>">
            <tr><td><h3><%=e.nome%></h3></td></tr>
            <tr><td><a href="#confirmar_delete<%=e.nome%>">Delete</a></td></tr>
            <tr>
                <%
                e.compassos.forEach(element1 => {
                %>
                <td>
                    <table id="<%=element1.nome_compasso%>">
                        <tr id="linha cabeçalho">
                            <%
                            let tamanho = (e.compass*e.beat_temp);
                            let cont = 0;
                            for(var i = 0;i < tamanho;i++) {
                                if((i%e.beat_temp)==0) {
                                    cont++
                                %>
                                <td>
                                    <h4><%=cont%></h4>
                                </td>
                                <%
                                }
                                else {
                                %>
                                <td></td>
                                <%
                                }
                            }
                            %>
                        </tr>
                        <%
                        element1.linhas.forEach(element2 => {
                        %>
                        <tr id="<%=element2.nome_linha%>">
                            <%
                            let k = 0;
                            element2.colunas.forEach(element3 => {
                            %>
                            <td><input type="checkbox" id="<%=element2.id_linha%>_<%=k%>"></td>
                            <%
                            k++
                            });
                            %>
                        </tr>
                        <%
                        });
                        %>
                    </table>
                </td>
                <%
                });
                %>
            </tr>
        </table>
        <%
        });
        %>
        <div id="criar" class="div_criar">
            <span><a href="#add_tab">+</a></span>
        </div>
    </main>


    <div id="add_tab" class="modal">
        <div>
            <a href="#fechar" title="fechar" class="fechar">X</a>
            <form action="/novo_trecho/<%= document.tablatura_id %>" method="post">
                <h2>Detalhes do techo</h2>
                <table>
                    <tr>
                        <td>Nome do trecho:</td>
                        <td><input type="text" name="detalhe_nome" id="detalhe_nome" placeholder="ex: verso1, ponte, solo, etc."></td>
                    </tr>
                    <tr>
                        <td>Tipo do compasso:</td>
                        <td><select name="tipo_compass" id="tipo_compass">
                            <option value="2">2/4</option>
                            <option value="3">3/4</option>
                            <option value="4" selected>4/4</option>
                            <option value="5">5/4</option>
                            <option value="7">7/8</option>
                        </select></td>
                    </tr>
                    <tr>
                        <td>Quantidade de compassos:</td>
                        <td><input type="number" name="quant_compass" id="quant_compass"></td>
                    </tr>
                    <tr>
                        <td>Batidas por tempo:</td>
                        <td><select name="beat_temp" id="beat_temp">
                            <option value="1">01</option>
                            <option value="2">02</option>
                            <option value="3">03</option>
                            <option value="4" selected>04</option>
                            <option value="5">05</option>
                            <option value="6">06</option>
                            <option value="7">07</option>
                            <option value="8">08</option>
                            <option value="9">09</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                        </select></td>
                    </tr>
                    <tr>
                        <td>numero de linhas (peças):</td>
                        <td><input type="number" name="num_row" id="num_row"></td>
                    </tr>
                </table>
                <p><button type="reset">Cancelar</button><button type="submit">Concluir</button></p>
            </form>
        </div>
    </div>
    <div id="deseja_voltar" class="modal">
        <div>
            <a href="#fechar" title="fechar" class="fechar">X</a>
            <h2>Deseja mesmo sair?</h2>
            <p>Voltar irá excluir todo o seu progresso não salvo nesta página.</p>
            <p><button>Cancelar</button><button>Sim</button></p>
        </div>
    </div>
    <footer></footer>
    <button id="btn1">opa!</button>
<script>
$("#btn1").click(function(){
    $.post('/opa',{
        a: "opa",b: "bom dia!"
    })
})
</script>
</body>
</html>